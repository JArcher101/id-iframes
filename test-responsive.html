<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Responsive iframe Test - ID Management System</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /*
        =====================================================================
        RESPONSIVE IFRAME TEST PAGE - STYLE SECTION
        =====================================================================
        This page provides a testing environment for all iframe components
        in the ID Management System.
        
        PURPOSE:
        - Test iframe responsiveness at different screen sizes
        - Preview components at common breakpoints (250px, 320px, 800px, 980px)
        - Apply custom dimensions for edge case testing
        - Switch between different iframe components dynamically
        
        AVAILABLE COMPONENTS:
        - Image Uploader (Client Details Form)
        - Image Viewer (View uploaded ID photos)
        - Document Viewer (View uploaded documents)
        - Message iframe (Cashiers Chat)
        - Cashiers Log (Transaction log)
        
        FEATURES:
        - Preset width buttons for common breakpoints
        - Custom width/height inputs for specific testing
        - Real-time iframe switching via dropdown
        - Collapsible information cards
        - Responsive two-column layout (stacks on mobile)
        =====================================================================
        */
        
        /* Global reset for consistent styling across browsers */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background: #f5f5f5;
            padding: 20px;
            line-height: 1.6;
        }

        /* 
        =====================================================================
        MAIN CONTAINER - Two-column grid layout
        - Left panel: Controls and information (400px fixed width)
        - Right panel: iframe preview area (flexible width)
        - Stacks to single column on tablets/mobile (< 1024px)
        =====================================================================
        */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 20px;
            min-height: 100vh;
        }

        /* 
        =====================================================================
        LEFT PANEL - Controls and Information
        - Contains title, description, instructions, and controls
        - Sticky positioning keeps it visible while scrolling
        - Moves below iframe on mobile/tablet (via @media query)
        =====================================================================
        */
        .left-panel {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        /* 
        =====================================================================
        RIGHT PANEL - iframe Preview Area
        - Contains the iframe container and current iframe being tested
        - Flexible width adapts to available space
        =====================================================================
        */
        .right-panel {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            padding: 20px;
            height: fit-content;
        }

        /* Main page title - Brand navy color */
        h1 {
            text-align: center;
            color: #003B5C;
            margin-bottom: 30px;
            font-size: 2rem;
        }

        /* 
        =====================================================================
        DESCRIPTION CARD - Collapsible information card
        - Explains the purpose of the test page
        - Can be collapsed/expanded by clicking header
        - Blue accent border for visual distinction
        =====================================================================
        */
        .description {
            background: #e8f4f8;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #003B5C;
            transition: all 0.3s ease;
        }

        /* Collapsed state - reduced padding */
        .description.collapsed {
            padding: 15px 20px;
        }

        /* 
        Description card header
        - Clickable to toggle collapse/expand
        - Arrow icon indicates collapsible state
        */
        .description h2 {
            color: #003B5C;
            margin-bottom: 10px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            user-select: none;
        }

        .description h2:hover {
            color: #002b43;
        }

        /* Description card content paragraphs */
        .description p {
            color: #555;
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        /* Hide content when collapsed */
        .description.collapsed p {
            display: none;
        }

        /* Code elements in description - inline display with proper styling */
        .description code {
            background: #d4e9f1;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.9em;
            color: #002b43;
            display: inline;
            white-space: normal;
            word-break: break-all;
        }

        /* 
        Collapse arrow indicator
        - Points down when expanded
        - Rotates -90deg (points right) when collapsed
        */
        .collapse-arrow {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
            color: #003B5C;
        }

        .description.collapsed .collapse-arrow {
            transform: rotate(-90deg);
        }

        /* 
        =====================================================================
        CONTROLS SECTION - Main testing controls
        - Contains iframe selector dropdown
        - Preset width buttons
        - Custom dimension inputs
        =====================================================================
        */
        .controls {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            text-align: center;
        }

        .controls h3 {
            color: #003B5C;
            margin-bottom: 15px;
        }

        /* 
        =====================================================================
        WIDTH BUTTONS - Preset breakpoint testing buttons
        - Four preset widths: 980px, 800px, 320px, 250px
        - Active button shown in green (#10a37f)
        - Hover effects for better UX
        =====================================================================
        */
        .width-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        /* Individual width button styling */
        .width-btn {
            background: #003B5C;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .width-btn:hover {
            background: #002b43;
            transform: translateY(-1px);
        }

        /* Active button state - green to indicate current selection */
        .width-btn.active {
            background: #10a37f;
            box-shadow: 0 2px 8px rgba(16, 163, 127, 0.3);
        }

        /* 
        =====================================================================
        IFRAME SELECTOR - Dropdown to switch between iframe components
        - Dynamically loads selected iframe in preview area
        - Updates title and dimensions based on selection
        =====================================================================
        */
        .iframe-selector {
            margin-bottom: 20px;
        }

        .iframe-selector label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #003B5C;
        }

        /* Dropdown select element */
        .iframe-dropdown {
            width: 100%;
            max-width: 300px;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 16px;
            background: white;
            color: #003B5C;
        }

        .iframe-dropdown:focus {
            outline: none;
            border-color: #003B5C;
        }

        /* 
        =====================================================================
        CUSTOM DIMENSIONS CARD - Collapsible custom size inputs
        - Allows testing at any width/height between 200px - 2000px
        - Validates inputs before applying
        - Can be collapsed to save space
        =====================================================================
        */
        .custom-dimensions {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border: 1px solid #e0e0e0;
            transition: all 0.3s ease;
        }

        /* Collapsed state - reduced padding */
        .custom-dimensions.collapsed {
            padding: 12px 15px;
        }

        /* Custom dimensions header - clickable to toggle collapse */
        .custom-dimensions h4 {
            color: #003B5C;
            margin-bottom: 15px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            user-select: none;
        }

        .custom-dimensions h4:hover {
            color: #002b43;
        }

        .custom-dimensions.collapsed h4 {
            margin-bottom: 0;
        }

        /* Dimension inputs wrapper - hidden when collapsed */
        .custom-dimensions .dimension-inputs {
            transition: all 0.3s ease;
        }

        .custom-dimensions.collapsed .dimension-inputs {
            display: none;
        }

        /* 
        Container for width/height inputs and apply button
        - Flexbox layout with gap
        - Wraps on small screens
        */
        .dimension-inputs {
            display: flex;
            gap: 15px;
            align-items: end;
            flex-wrap: wrap;
        }

        /* Individual input field group (label + input) */
        .input-group {
            display: flex;
            flex-direction: column;
            min-width: 120px;
        }

        .input-group label {
            font-size: 0.9rem;
            font-weight: 600;
            color: #003B5C;
            margin-bottom: 5px;
        }

        /* Number input for width/height values */
        .input-group input {
            padding: 8px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 4px;
            font-size: 14px;
            width: 100%;
        }

        .input-group input:focus {
            outline: none;
            border-color: #003B5C;
        }

        /* Apply button for custom dimensions - green accent color */
        .custom-btn {
            background: #10a37f;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
            height: fit-content;
        }

        .custom-btn:hover {
            background: #0d8a6b;
            transform: translateY(-1px);
        }

        /* 
        =====================================================================
        IFRAME CONTAINER - Preview area styling
        - Contains iframe header and the actual iframe element
        - Width dynamically changes based on preset or custom selection
        - Smooth transitions for dimension changes
        =====================================================================
        */
        .iframe-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 30px;
            transition: all 0.3s ease;
        }

        /* Individual iframe section wrapper */
        .iframe-section {
            margin-bottom: 30px;
        }

        .iframe-section:last-child {
            margin-bottom: 0;
        }

        /* 
        iframe header section
        - Shows component name and current dimensions
        - Flexbox layout for alignment
        */
        .iframe-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }

        .iframe-header h3 {
            color: #003B5C;
            font-size: 1.2rem;
        }

        /* Size indicator badge - shows current iframe dimensions */
        .iframe-size-info {
            background: #e8f4f8;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.9rem;
            color: #003B5C;
            font-weight: 600;
        }

        /* Global iframe styling */
        iframe {
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            transition: all 0.3s ease;
            background: white;
        }

        /* 
        Test iframe element
        - Width and height set dynamically via JavaScript
        - Default: 100% width, 600px height
        - Centered within container using margin auto
        */
        .test-iframe {
            width: 100%;
            height: 600px;
            display: block;
            margin: 0 auto;
        }

        /* 
        =====================================================================
        RESPONSIVE ADJUSTMENTS
        - Tablet (< 1024px): Stack panels vertically, settings shown first
        - Mobile (< 768px): Reduce spacing, stack controls vertically
        =====================================================================
        */
        @media (max-width: 1024px) {
            .container {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            /* Show controls panel first, iframe preview below */
            .left-panel {
                position: static;
                order: 1;
            }
            
            .right-panel {
                order: 2;
            }
        }

        @media (max-width: 768px) {
            body { padding: 10px; }
            h1 { font-size: 1.5rem; }
            .width-buttons { flex-direction: column; align-items: center; }
            .width-btn { width: 200px; }
            .dimension-inputs { flex-direction: column; align-items: stretch; }
            .input-group { min-width: auto; }
        }

        /* 
        =====================================================================
        PRESET WIDTH CLASSES - Applied to iframe container
        - Four preset widths matching common breakpoints
        - Set by JavaScript when preset buttons are clicked
        - Width = iframe width + 40px (to account for 20px padding on each side)
        =====================================================================
        */
        .width-250 {
            width: 290px;
        }

        .width-320 {
            width: 360px;
        }

        .width-800 {
            width: 840px;
        }

        .width-970 {
            width: 1010px;
        }

        .width-980 {
            width: 1020px;
        }

        /* 
        =====================================================================
        INSTRUCTIONS CARD - Collapsible testing instructions
        - Yellow/warning color scheme for visibility
        - Can be collapsed to save space
        - Lists step-by-step testing procedures
        =====================================================================
        */
        .instructions {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        /* Collapsed state - reduced padding */
        .instructions.collapsed {
            padding: 12px 15px;
        }

        /* Instructions header - clickable to toggle collapse */
        .instructions h4 {
            color: #856404;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            user-select: none;
        }

        .instructions h4:hover {
            color: #6c4a00;
        }

        /* Instructions list */
        .instructions ul {
            color: #856404;
            margin-left: 20px;
            transition: all 0.3s ease;
        }

        /* Hide list when collapsed */
        .instructions.collapsed ul {
            display: none;
        }

        .instructions li {
            margin-bottom: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="left-panel">
            <h1>Responsive iframe Test</h1>
            
            <div class="description collapsed" id="descriptionCard">
                <h2 onclick="toggleCard('descriptionCard')">
                    ID Management System - Responsive Testing
                    <span class="collapse-arrow">▼</span>
                </h2>
                <p>This page allows you to test any iframe component at different screen sizes and custom dimensions.</p>
                <p><strong>Available Components:</strong> Image Uploader, Image Viewer, Document Viewer, Message iframe, and Cashiers Log</p>
                <p><strong>Testing Features:</strong> Preset width buttons, custom dimension inputs, and real-time iframe switching</p>
                <p><strong>URL Parameters:</strong> Configure the page via URL - <code>?iframe=document-viewer.html&width=320&height=500&desc=true&instructions=true&custom=true</code></p>
                <p style="margin-left: 20px; font-size: 0.9em;">
                    • <code>iframe</code> - Set iframe to load (e.g., message-iframe.html)<br>
                    • <code>width</code> - Set width in pixels (200-2000)<br>
                    • <code>height</code> - Set height in pixels (200-2000)<br>
                    • <code>desc</code> - Expand description card (true/1/yes)<br>
                    • <code>instructions</code> - Expand instructions card (true/1/yes)<br>
                    • <code>custom</code> - Expand custom dimensions card (true/1/yes)
                </p>
            </div>

            <div class="instructions collapsed" id="instructionsCard">
                <h4 onclick="toggleCard('instructionsCard')">
                    Testing Instructions
                    <span class="collapse-arrow">▼</span>
                </h4>
                <ul>
                    <li>Select an iframe component from the dropdown above</li>
                    <li>Use preset width buttons (250px-980px) to test common breakpoints</li>
                    <li>Enter custom width and height values for specific testing needs</li>
                    <li>Observe how each component adapts to different screen sizes</li>
                    <li>Test mobile responsiveness at 250px and 320px</li>
                    <li>Verify desktop layout at 800px and 980px</li>
                    <li>Use custom dimensions to test edge cases or specific requirements</li>
                </ul>
            </div>

            <div class="controls">
                <h3>Test Different Dimensions</h3>
                
                <div class="iframe-selector">
                    <label for="iframeSelect">Select iframe to test:</label>
                    <select id="iframeSelect" class="iframe-dropdown">
                        <option value="image-uploader.html">Image Uploader</option>
                        <option value="image-viewer.html">Image Viewer</option>
                        <option value="document-viewer.html">Document Viewer</option>
                        <option value="message-iframe.html">Message iframe</option>
                        <option value="cashiers-log.html">Cashiers Log</option>
                        <option value="report-uploader.html">Report Uploader</option>
                        <option value="client-details.html">Client Details Form</option>
                    </select>
                </div>

                <div class="width-buttons">
                    <button class="width-btn active" data-width="980">980px (Desktop)</button>
                    <button class="width-btn" data-width="970">970px (Card 950px)</button>
                    <button class="width-btn" data-width="800">800px (Laptop)</button>
                    <button class="width-btn" data-width="320">320px (Mobile)</button>
                    <button class="width-btn" data-width="250">250px (Small Mobile)</button>
                </div>

                <div class="custom-dimensions collapsed" id="customDimensionsCard">
                    <h4 onclick="toggleCard('customDimensionsCard')">
                        Custom Dimensions
                        <span class="collapse-arrow">▼</span>
                    </h4>
                    <div class="dimension-inputs">
                        <div class="input-group">
                            <label for="customWidth">Width (px):</label>
                            <input type="number" id="customWidth" placeholder="980" min="200" max="2000">
                        </div>
                        <div class="input-group">
                            <label for="customHeight">Height (px):</label>
                            <input type="number" id="customHeight" placeholder="600" min="200" max="2000">
                        </div>
                        <button id="applyCustom" class="custom-btn">Apply</button>
                    </div>
                </div>

            </div>
        </div>

        <div class="right-panel">
            <div class="iframe-container" id="iframeContainer">
                <div class="iframe-section">
                    <div class="iframe-header">
                        <h3 id="iframeTitle">Image Uploader (Client Details Form)</h3>
                        <div class="iframe-size-info">
                            <span id="iframeSize">980px × 600px</span>
                        </div>
                    </div>
                    <iframe 
                        id="testIframe"
                        class="test-iframe"
                        src="image-uploader.html"
                        title="Test iframe">
                    </iframe>
                </div>
            </div>
        </div>
    </div>

    <script>
        /*
        =====================================================================
        RESPONSIVE IFRAME TEST PAGE - JAVASCRIPT SECTION
        =====================================================================
        
        PURPOSE:
        This script manages the iframe testing interface, allowing users to:
        - Switch between different iframe components
        - Test at preset breakpoint widths
        - Apply custom dimensions
        - Toggle collapsible information cards
        
        CONFIGURATION OBJECTS:
        - iframeConfig: Defines available iframes and their default heights
        - widthConfig: Defines preset width breakpoints and associated settings
        
        STATE MANAGEMENT:
        - currentWidth: Current iframe width in pixels
        - currentHeight: Current iframe height in pixels
        
        EVENT HANDLING:
        - iframe selection change
        - Preset width button clicks
        - Custom dimension application
        - Card collapse/expand toggles
        
        KEY FUNCTIONS:
        - updateIframeDisplay(): Updates iframe src, dimensions, and display info
        - toggleCard(): Toggles collapse state of information cards
        =====================================================================
        */
        
        /* 
        =====================================================================
        IFRAME CONFIGURATION OBJECT
        - Maps iframe filename to display name and default height
        - Default heights optimized for each component type
        - Used to populate dropdown and set initial dimensions
        =====================================================================
        */
        const iframeConfig = {
            'image-uploader.html': { name: 'Image Uploader', defaultHeight: '900px' },
            'image-viewer.html': { name: 'Image Viewer', defaultHeight: '600px' },
            'document-viewer.html': { name: 'Document Viewer', defaultHeight: '600px' },
            'message-iframe.html': { name: 'Message iframe', defaultHeight: '500px' },
            'cashiers-log.html': { name: 'Cashiers Log', defaultHeight: '400px' },
            'report-uploader.html': { name: 'Report Uploader', defaultHeight: '200px' },
            'client-details.html': { name: 'Client Details Form', defaultHeight: '700px' }
        };

        /* 
        =====================================================================
        WIDTH CONFIGURATION OBJECT
        - Defines preset breakpoints (980px, 800px, 320px, 250px)
        - Each breakpoint has:
        *   container: CSS class to apply to iframe container
        *   height: Default iframe height for this breakpoint
        *   label: Display label for button text
        - Heights adjusted based on typical content needs at each breakpoint
        =====================================================================
        */
        const widthConfig = {
            '980': { 
                container: 'width-980',
                height: '600px',
                label: 'Desktop'
            },
            '970': { 
                container: 'width-970',
                height: '700px',
                label: 'Card 950px'
            },
            '800': { 
                container: 'width-800',
                height: '600px',
                label: 'Laptop'
            },
            '320': { 
                container: 'width-320',
                height: '500px',
                label: 'Mobile'
            },
            '250': { 
                container: 'width-250',
                height: '400px',
                label: 'Small Mobile'
            }
        };

        /* 
        =====================================================================
        DOM ELEMENT REFERENCES
        - Cached for performance (avoid repeated querySelector calls)
        - All interactive elements and display elements
        =====================================================================
        */
        const widthButtons = document.querySelectorAll('.width-btn');
        const iframeSelect = document.getElementById('iframeSelect');
        const iframeContainer = document.getElementById('iframeContainer');
        const testIframe = document.getElementById('testIframe');
        const iframeTitle = document.getElementById('iframeTitle');
        const iframeSize = document.getElementById('iframeSize');
        const customWidthInput = document.getElementById('customWidth');
        const customHeightInput = document.getElementById('customHeight');
        const applyCustomBtn = document.getElementById('applyCustom');

        /* 
        =====================================================================
        GLOBAL STATE - Current iframe dimensions
        - Initialized to desktop defaults (980px × 600px)
        - Updated by preset buttons or custom inputs
        - Used by updateIframeDisplay() to set iframe size
        =====================================================================
        */
        let currentWidth = 980;
        let currentHeight = 600;

        /*
        =====================================================================
        UPDATE IFRAME DISPLAY - Main function to refresh iframe preview
        =====================================================================
        Called whenever iframe selection or dimensions change
        
        Actions performed:
        1. Gets selected iframe filename from dropdown
        2. Looks up configuration (name, default height)
        3. Updates iframe src attribute to load new component
        4. Updates iframe title attribute for accessibility
        5. Updates header text to show component name
        6. Applies current width and height to iframe element
        7. Updates size indicator badge with dimensions
        8. Logs change to console for debugging
        
        Dependencies:
        - Requires currentWidth and currentHeight to be set
        - Uses iframeConfig object for component metadata
        =====================================================================
        */
        function updateIframeDisplay() {
            const selectedIframe = iframeSelect.value;
            const config = iframeConfig[selectedIframe];
            
            // Update iframe source and title
            testIframe.src = selectedIframe;
            testIframe.title = config.name;
            iframeTitle.textContent = config.name;
            
            // Update dimensions - applied as inline styles
            testIframe.style.width = `${currentWidth}px`;
            testIframe.style.height = `${currentHeight}px`;
            
            // Update iframe header display (size indicator badge)
            iframeSize.textContent = `${currentWidth}px × ${currentHeight}px`;
            
            console.log(`Switched to ${config.name} at ${currentWidth}x${currentHeight}`);
        }

        /*
        =====================================================================
        IFRAME SELECTION CHANGE HANDLER
        =====================================================================
        Triggered when user selects different iframe from dropdown
        
        Flow:
        1. Gets selected iframe value
        2. Looks up default height from config
        3. Updates currentHeight to component-specific default
        4. Updates custom height input field to match
        5. Calls updateIframeDisplay() to load new iframe
        6. Updates URL to reflect new selection
        
        Note: Width remains unchanged - only height resets to default
        This allows user to maintain their width preference across switches
        =====================================================================
        */
        iframeSelect.addEventListener('change', () => {
            const selectedIframe = iframeSelect.value;
            const config = iframeConfig[selectedIframe];
            
            // Set default height for the selected iframe component
            currentHeight = parseInt(config.defaultHeight);
            customHeightInput.value = currentHeight;
            
            updateIframeDisplay();
            updateUrl();
        });

        /*
        =====================================================================
        PRESET WIDTH BUTTON CLICK HANDLERS
        =====================================================================
        Attached to all width preset buttons (980px, 800px, 320px, 250px)
        
        Flow:
        1. Gets width value from button's data-width attribute
        2. Looks up configuration (container class, default height)
        3. Removes 'active' class from all buttons
        4. Adds 'active' class to clicked button (green styling)
        5. Updates global state (currentWidth, currentHeight)
        6. Updates custom input fields to match new dimensions
        7. Applies width class to container (e.g., 'width-980')
        8. Calls updateIframeDisplay() to apply changes
        9. Updates URL to reflect new dimensions
        
        Note: Each preset has its own default height optimized for that breakpoint
        =====================================================================
        */
        widthButtons.forEach(button => {
            button.addEventListener('click', () => {
                const width = parseInt(button.dataset.width);
                const config = widthConfig[button.dataset.width];
                
                // Update active button styling - only one active at a time
                widthButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                
                // Update global dimension state
                currentWidth = width;
                currentHeight = parseInt(config.height);
                
                // Sync custom input fields with preset values
                customWidthInput.value = currentWidth;
                customHeightInput.value = currentHeight;
                
                // Apply preset width class to container
                iframeContainer.className = `iframe-container ${config.container}`;
                
                updateIframeDisplay();
                updateUrl();
            });
        });

        /*
        =====================================================================
        CUSTOM DIMENSIONS APPLY BUTTON HANDLER
        =====================================================================
        Triggered when user clicks "Apply" button in custom dimensions section
        
        Validation:
        - Both width and height must be provided
        - Values must be between 200px and 2000px (inclusive)
        - Shows alert if validation fails
        
        Flow on success:
        1. Parses width and height from input fields
        2. Validates range (200-2000px)
        3. Updates global state (currentWidth, currentHeight)
        4. Removes 'active' class from all preset buttons (custom mode)
        5. Removes preset width class from container
        6. Applies custom width as inline style
        7. Calls updateIframeDisplay() to apply changes
        8. Updates URL to reflect new dimensions
        
        Note: Custom dimensions override preset button selections
        =====================================================================
        */
        applyCustomBtn.addEventListener('click', () => {
            const customWidth = parseInt(customWidthInput.value);
            const customHeight = parseInt(customHeightInput.value);
            
            // Validate input ranges (200px minimum, 2000px maximum)
            if (customWidth && customHeight && customWidth >= 200 && customWidth <= 2000 && customHeight >= 200 && customHeight <= 2000) {
                currentWidth = customWidth;
                currentHeight = customHeight;
                
                // Remove active state from preset buttons (now in custom mode)
                widthButtons.forEach(btn => btn.classList.remove('active'));
                
                // Remove preset width class and apply custom width (add 40px for padding)
                iframeContainer.className = 'iframe-container';
                iframeContainer.style.width = `${currentWidth + 40}px`;
                
                updateIframeDisplay();
                updateUrl();
            } else {
                alert('Please enter valid dimensions (200-2000px)');
            }
        });

        /*
        =====================================================================
        IFRAME COMMUNICATION LISTENER
        =====================================================================
        Listens for postMessage events from child iframes
        
        Purpose:
        - Allows child iframes to communicate with test page
        - Useful for debugging and monitoring iframe behavior
        
        Example use cases:
        - Image Uploader sends 'upload-complete' when files uploaded
        - Message iframe sends chat messages
        - Document Viewer sends file download events
        
        Note: Currently logs all messages for debugging
        Can be extended to handle specific message types
        =====================================================================
        */
        window.addEventListener('message', function(event) {
            console.log('Test page received message:', event.data);
            
            // Handle upload completion from uploader iframe
            if (event.data.type === 'upload-complete') {
                console.log('Upload completed, data received:', event.data);
            }
        });

        /*
        =====================================================================
        TOGGLE CARD - Collapse/Expand collapsible cards
        =====================================================================
        Parameters:
        - cardId: ID of the card element to toggle
        
        Used by:
        - Description card (descriptionCard)
        - Instructions card (instructionsCard)
        - Custom dimensions card (customDimensionsCard)
        
        Behavior:
        - Toggles 'collapsed' class on/off
        - CSS handles visual changes (padding, content visibility)
        - Arrow icon rotates via CSS transition
        - Updates URL to reflect new state
        =====================================================================
        */
        function toggleCard(cardId) {
            const card = document.getElementById(cardId);
            card.classList.toggle('collapsed');
            updateUrl();
        }

        /*
        =====================================================================
        URL PARAMETER PARSER
        =====================================================================
        Parses URL query parameters and applies settings on page load
        
        Supported parameters:
        - iframe: Set the selected iframe (e.g., ?iframe=document-viewer.html)
        - width: Set the iframe width in pixels (e.g., ?width=320)
        - height: Set the iframe height in pixels (e.g., ?height=500)
        - desc: Expand description card (true/1/yes, default collapsed)
        - instructions: Expand instructions card (true/1/yes, default collapsed)
        - custom: Expand custom dimensions card (true/1/yes, default collapsed)
        
        Example URLs:
        - ?iframe=message-iframe.html&width=320&height=500
        - ?iframe=document-viewer.html&width=800&height=600&desc=true
        - ?width=250&height=400&instructions=true&custom=true
        =====================================================================
        */
        function applyUrlParameters() {
            const urlParams = new URLSearchParams(window.location.search);
            
            // Helper function to check if a parameter is "truthy"
            const isTrue = (value) => {
                if (!value) return false;
                const v = value.toLowerCase();
                return v === 'true' || v === '1' || v === 'yes';
            };
            
            // Apply iframe selection if specified
            if (urlParams.has('iframe')) {
                const iframeParam = urlParams.get('iframe');
                // Check if the iframe exists in our config
                if (iframeConfig[iframeParam]) {
                    iframeSelect.value = iframeParam;
                    // Update height to the default for this iframe
                    currentHeight = parseInt(iframeConfig[iframeParam].defaultHeight);
                    console.log(`URL param: Set iframe to ${iframeParam}`);
                }
            }
            
            // Apply width if specified
            if (urlParams.has('width')) {
                const widthParam = parseInt(urlParams.get('width'));
                if (widthParam >= 200 && widthParam <= 2000) {
                    currentWidth = widthParam;
                    console.log(`URL param: Set width to ${widthParam}px`);
                    
                    // Check if this matches a preset width
                    const matchingPreset = widthConfig[widthParam.toString()];
                    if (matchingPreset) {
                        // Activate the corresponding preset button
                        widthButtons.forEach(btn => {
                            btn.classList.remove('active');
                            if (parseInt(btn.dataset.width) === widthParam) {
                                btn.classList.add('active');
                            }
                        });
                        iframeContainer.className = `iframe-container ${matchingPreset.container}`;
                    } else {
                        // Custom width - remove all active states (add 40px for padding)
                        widthButtons.forEach(btn => btn.classList.remove('active'));
                        iframeContainer.className = 'iframe-container';
                        iframeContainer.style.width = `${widthParam + 40}px`;
                    }
                }
            }
            
            // Apply height if specified (overrides iframe default)
            if (urlParams.has('height')) {
                const heightParam = parseInt(urlParams.get('height'));
                if (heightParam >= 200 && heightParam <= 2000) {
                    currentHeight = heightParam;
                    console.log(`URL param: Set height to ${heightParam}px`);
                }
            }
            
            // Apply collapsible card states
            // Description card
            if (urlParams.has('desc') || urlParams.has('description')) {
                const descValue = urlParams.get('desc') || urlParams.get('description');
                const descCard = document.getElementById('descriptionCard');
                if (isTrue(descValue)) {
                    descCard.classList.remove('collapsed');
                    console.log('URL param: Expanded description card');
                } else {
                    descCard.classList.add('collapsed');
                }
            }
            
            // Instructions card
            if (urlParams.has('instructions')) {
                const instructionsValue = urlParams.get('instructions');
                const instructionsCard = document.getElementById('instructionsCard');
                if (isTrue(instructionsValue)) {
                    instructionsCard.classList.remove('collapsed');
                    console.log('URL param: Expanded instructions card');
                } else {
                    instructionsCard.classList.add('collapsed');
                }
            }
            
            // Custom dimensions card
            if (urlParams.has('custom') || urlParams.has('customDimensions')) {
                const customValue = urlParams.get('custom') || urlParams.get('customDimensions');
                const customCard = document.getElementById('customDimensionsCard');
                if (isTrue(customValue)) {
                    customCard.classList.remove('collapsed');
                    console.log('URL param: Expanded custom dimensions card');
                } else {
                    customCard.classList.add('collapsed');
                }
            }
        }

        /*
        =====================================================================
        UPDATE URL - Sync URL params with current state
        =====================================================================
        Updates the browser URL to reflect the current page configuration
        without reloading the page. This allows users to copy/share the URL
        with the exact current settings.
        
        Called automatically when:
        - Page loads (to set initial params if not present)
        - User changes iframe selection
        - User changes dimensions
        - User toggles collapsible cards
        
        Uses history.replaceState() to avoid creating browser history entries
        =====================================================================
        */
        function updateUrl() {
            const params = new URLSearchParams();
            
            // Add iframe parameter
            params.set('iframe', iframeSelect.value);
            
            // Add width and height parameters
            params.set('width', currentWidth);
            params.set('height', currentHeight);
            
            // Add collapsible card states (only if expanded)
            const descCard = document.getElementById('descriptionCard');
            if (!descCard.classList.contains('collapsed')) {
                params.set('desc', 'true');
            }
            
            const instructionsCard = document.getElementById('instructionsCard');
            if (!instructionsCard.classList.contains('collapsed')) {
                params.set('instructions', 'true');
            }
            
            const customCard = document.getElementById('customDimensionsCard');
            if (!customCard.classList.contains('collapsed')) {
                params.set('custom', 'true');
            }
            
            // Update URL without reloading page
            const newUrl = `${window.location.pathname}?${params.toString()}`;
            history.replaceState(null, '', newUrl);
        }

        /*
        =====================================================================
        INITIALIZATION
        =====================================================================
        Runs when page loads to set up initial state
        
        Actions:
        1. Logs available iframes and widths to console
        2. Applies URL parameters if present
        3. Sets custom input fields to match current dimensions
        4. Calls updateIframeDisplay() to render initial iframe
        5. Updates URL to include all current settings
        
        Default state (no URL params):
        - iframe: Image Uploader (first option in dropdown)
        - Width: 980px (Desktop preset, active button)
        - Height: 600px (Default for Image Uploader)
        - All cards: Collapsed
        
        URL is always updated to reflect current state, making it easy
        to copy/share the exact configuration.
        =====================================================================
        */
        console.log('Responsive iframe test page loaded');
        console.log('Available iframes:', Object.keys(iframeConfig));
        console.log('Available widths:', Object.keys(widthConfig));
        
        // Apply URL parameters if present
        applyUrlParameters();
        
        // Set initial values in custom dimension inputs
        customWidthInput.value = currentWidth;
        customHeightInput.value = currentHeight;
        
        // Render initial iframe with applied settings
        updateIframeDisplay();
        
        // Update URL to reflect current state (sets default params if none present)
        updateUrl();
    </script>
</body>
</html>
